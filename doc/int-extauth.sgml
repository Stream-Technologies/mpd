<!-- $Id: int-extauth.sgml,v 1.4 2007/10/05 17:36:02 amotin Exp $ -->
<!-- mpd netgraph enabled user mode PPP daemon -->

<!-- <!DOCTYPE linuxdoc PUBLIC '-//FreeBSD//DTD linuxdoc//EN'> -->

  <sect><heading>External authentication<label id="internalsextauth"></heading>

  <p>
  This chapter describes implementation specific details of MPD.

Mpd supports authentication and accounting by calling external scripts. 
Pathes to that scripts must be specified using <tt><bf>set auth extauth-script ...</bf></tt>
and <tt><bf>set auth extacct-script ...</bf></tt> commands.

On invocation extauth script receives on stdin set of request 
attribute:value pairs terminated by empty line and must generate
response in same format on stdout.

Currently supported request attributes:
<verb>
USER_NAME
USER_PASSWORD - present for PAP auth only
NAS_PORT
NAS_PORT_TYPE
CALLING_STATION_ID
CALLED_STATION_ID
PEER_ADDR
PEER_PORT
PEER_IDENT
</verb>

Currently supported response attributes:
<verb>
RESULT - one of SUCCESS, UNDEF or FAIL
USER_NAME
USER_PASSWORD - if RESULT=UNDEF this field should contain correct user password
FRAMED_IP_ADDRESS
FRAMED_ROUTE
FRAMED_IPV6_ROUTE
FRAMED_MTU
FRAMED_POOL
SESSION_TIMEOUT
IDLE_TIMEOUT
REPLY_MESSAGE
MS_CHAP_ERROR
MPD_RULE
MPD_PIPE
MPD_QUEUE
MPD_TABLE
MPD_TABLE_STATIC
MPD_FILTER
MPD_LIMIT
</verb>

On invocation extacct script receives on stdin set of request 
attribute:value pairs terminated by empty line and must generate
response in same format on stdout.

Currently supported request attributes:
<verb>
ACCT_STATUS_TYPE
ACCT_SESSION_ID
ACCT_MULTI_SESSION_ID
USER_NAME
LINK
NAS_PORT
NAS_PORT_TYPE
ACCT_LINK_COUNT
CALLING_STATION_ID
CALLED_STATION_ID
PEER_ADDR
PEER_PORT
PEER_IDENT
FRAMED_IP_ADDRESS
ACCT_TERMINATE_CAUSE
ACCT_SESSION_TIME
ACCT_INPUT_OCTETS
ACCT_INPUT_PACKETS
ACCT_OUTPUT_OCTETS
ACCT_OUTPUT_PACKETS
</verb>

Currently supported response attributes:
<verb>
MPD_DROP_USER - nonzero value means that link should be disconnected
</verb>

Script may specify any combination of those attributes it needs. 
The only mandatory attribute is RESULT. For description of most
attributes look their RADIUS alternatives.

</p>
