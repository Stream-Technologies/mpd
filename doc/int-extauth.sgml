<!-- $Id: int-extauth.sgml,v 1.2 2007/06/03 22:35:29 amotin Exp $ -->
<!-- mpd netgraph enabled user mode PPP daemon -->

<!-- <!DOCTYPE linuxdoc PUBLIC '-//FreeBSD//DTD linuxdoc//EN'> -->

  <sect><heading>External authentication<label id="internalsextauth"></heading>

  <p>
  This chapter describes implementation specific details of MPD.

Mpd supports authentication by calling external authentination script. 
Path to that script must be specified using <tt><bf>set auth extauth-script ...</bf></tt>
command.

On invocation this script receives on stdin set of request 
attribute:value pairs terminated by empty line and must generate
response in same format on stdout.

Currently supported request attributes:
<verb>
USER_NAME
USER_PASSWORD - for PAP only
NAS_PORT
NAS_PORT_TYPE
CALLING_STATION_ID
CALLED_STATION_ID
PEER_ADDR
PEER_PORT
</verb>

Currently supported response attributes:
<verb>
RESULT - one of SUCCESS, UNDEF (if valid USER_PASSWORD returned) or FAIL
USER_NAME
USER_PASSWORD
FRAMED_IP_ADDRESS
FRAMED_ROUTE
FRAMED_IPV6_ROUTE
FRAMED_MTU
FRAMED_POOL
SESSION_TIMEOUT
IDLE_TIMEOUT
REPLY_MESSAGE
MS_CHAP_ERROR
MPD_RULE
MPD_PIPE
MPD_QUEUE
MPD_TABLE
MPD_TABLE_STATIC
MPD_FILTER
MPD_LIMIT
</verb>

For description of most attributes look their RADIUS alternatives.

</p>
