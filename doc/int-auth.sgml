<!-- $Id: links.sgml,v 1.6 2002/09/05 01:20:51 archiecobbs Exp $ -->
<!-- mpd netgraph enabled user mode PPP daemon -->

<!-- <!DOCTYPE linuxdoc PUBLIC '-//FreeBSD//DTD linuxdoc//EN'> -->

  <sect><heading>Authentication<label id="authentication"></heading>

  <p>
  This chapter describes implementation specific details of MPD.

<descrip>

<tag>Authentication protocols - a short overview</tag>
<p>
Currently MPD supports these four authentication protocols: MD5-CHAP MS-CHAPv1 MS-CHAPv2 PAP

The traditional CHAP-MD5 needs the plaintext password stored on the server. The password hash is computed like this: md5(id + password + challenge), whereas the id is incremented after each authentication try. The challenge is generated by the server and then sent to the client (peer). The peer sends the hash to the server and the server genrates himself the hash using the plaintext password. If both hash are the same, the authentication succeeds.

MS-CHAP doesen't need plaintext passwords on the server, but also needs the password either as NT-Hash and/or as LAN-Manager-Hash (LAN-Manager-Hashes are weak and shouldn't be used anymore). 
MS-CHAPv1 uses DES as hashing algorithm and is weak, therefore don't use it anymore! 
MS-CHAPv2 uses a peer challenge and a server challenge and uses SHA1 as hashing algorithm, so it's much more secure then MS-CHAPv1.

When using PAP the password is sent as plaintext over the network, therefore PAP should be avoided, if possible. On the other hand PAP would allow using any kind of password database on the server, even if the passwords are stored using a non-revertable algorythm.

Usualy Unix/Linux systems have a different non-revertable hashing algorithm for passwords, therefore it is not possible to use master.passwd/shadow as password database, if you wan't to use any CHAP algorythm, except FreeBSD > 5.1 supports NT-Hashes in the master.passwd, configurable via login.conf (:passwd_format=nth:), however currently MPD doesen't support authentication against master.passwd.

Note: in order to get MPPE to work MS-CHAPv1 or MS-CHAPv2 is mandatory, it is not possible to use PAP or traditional CHAP-MD5.

</p>

<tag>Authentication protocol negotiation</tag>
<p>
Starting with MPD 3.14, MPD behaves very smart when negotiating auth-protos. MPD searches an internal list of protocols - most to least secure - until a valid auth-proto was found. If the link is a pptp link, then MS-CHAP is prefered otherwise CHAP-MD5 is prefered as most secure auth-proto.
</p>

</descrip>


</p>

